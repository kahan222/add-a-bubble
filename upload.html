<!DOCTYPE html>
<html>
<head>
  <title>Add a Bubble ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</title>
  <!-- ì˜¬ë°”ë¥¸ Firebase CDN -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
</head>
<body>
  <h2>ğŸ«§ Add a Bubble ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</h2>
  <input type="file" id="fileInput" accept="image/*" />
  <button onclick="uploadImage()">Upload</button>

  <script>
    // ğŸ”‘ ë¨¼ì € ì„ ì–¸: imgbb API í‚¤
    const imgbbApiKey = "f9427d6d511849d1476fdc31971a3b93";

    // ğŸ”§ Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyCtN3FJJs73iGyRY9IqwKM5-oQCDeW0qZo",
      authDomain: "addabubble-aeeb7.firebaseapp.com",
      projectId: "addabubble-aeeb7"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function uploadImage() {
      const fileInput = document.getElementById("fileInput");
      const file = fileInput.files[0];
      if (!file) return alert("ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”!");

      const reader = new FileReader();
      reader.onload = async function () {
        const base64 = reader.result.replace(/^data:image\/[a-z]+;base64,/, "");

        const formData = new FormData();
        formData.append("key", imgbbApiKey);
        formData.append("image", base64);

        const res = await fetch("https://api.imgbb.com/1/upload", {
          method: "POST",
          body: formData
        });
        const data = await res.json();
        const imageUrl = data.data.url;

        // Firestoreì— ì €ì¥
        await db.collection("screenshots").add({
          imageUrl: imageUrl,
          sticker: "Why so serious?",
          timestamp: new Date().toISOString()
        });

        alert("âœ… ì—…ë¡œë“œ ì„±ê³µ!");
        console.log("ì €ì¥ëœ ì´ë¯¸ì§€ URL:", imageUrl);
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>

